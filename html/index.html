<!doctype html>
<!--suppress JSUnresolvedReference -->
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title id="appName"></title>
    <meta name="author" content="Tien Dung Le">
    <!-- Fonts -->
    <!-- <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Chivo Mono"> -->
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="bootstrap-5.3.3-dist/css/bootstrap.css">
    <link rel="stylesheet" href="bootstrap-5.3.3-dist/css/styling.css">
    <!--suppress JSUnresolvedLibraryURL -->
    <link rel="stylesheet" href="bootstrap-5.3.3-dist/aos/aos-next/src/sass/aos.scss" />
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <style>
        .wordSearchTable {
            border-collapse: collapse;
            font-size: 12px;
        }
        
        td {
            border: 1px solid #ccc;
            width: 20px;
            height:20px;
            text-align: center;
            line-height: 15px;
            margin: 0; 
        }
    </style>
</head>

<body>
<div>
    <div class="container-fluid custom-footer" data-aos="fade-down">
        <nav class="navbar navbar-expand-sm navbar-dark container">
            <a href="index.html" class="navbar-brand" ><img src="../asset/navBarIcon.png" width="200" height="70"></a>


            <!-- Create ticket to fix this, doesn't respone on click  -->
            
            <!--
                <button class="navbar-toggler collapsed d-flex d-lg-none flex-column justify-content-around" type="button"
                    data-bs-toggle="collapse" data-bs-target="#toggleMobileMenu" aria-controls="toggleMobileMenu"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="toggler-icon top-bar"></span>
                    <span class="toggler-icon middle-bar"></span>
                    <span class="toggler-icon bottom-bar"></span>

                </button> 
            -->
            


            <div class="collapse navbar-collapse" id="toggleMobileMenu">
                <ul class="navbar-nav ms-auto text-end">
                    <li>
                        <a class="nav-link" href="#">HOME</a>
                    </li>
                    <li>
                        <a class="nav-link" href="#leaderboard">LEADERBOARD</a>
                    </li>
                    <li>
                        <a class="nav-link" href="#profile" onclick="showProfile()" disabled>PROFILE</a> 
                    </li>
                    <li>
                        <a class="nav-link" href="#contact">SUPPORT</a>
                    </li>


                </ul>
            </div>
        </nav>
    </div>
    <div class="container-fluid custom-body" id="log-in">
        <div id="home" class="container-fluid text-center flex-column d-flex justify-content-center align-items-center"
            style="height: 100vh;">
            <h1 style="font-size: 5vw;">READY TO SEARCH?</h1>
            <h3 >THERE ARE #_ PLAYERS IN THE LOBBY</h3>
            <h4 >ENTER YOUR USERNAME TO START</h4>
            <form name="userForm">
                <div class="input-group mb-2 ">
                    <span class="input-group-text" id="basic-addon1">@</span>
                    <input id="username" name="fname" type="text" class="form-control" placeholder="EX: JOHNLEE123" aria-label="Username"
                        aria-describedby="basic-addon1">
                </div>
            </form>
            <a class="btn btn-primary justify-content-center btn-lg active" onclick=buttonclicked(1) role="button" aria-pressed="true">
                JOIN LOBBY
            </a>
            
        </div>
    </div>

    <div class="d-flex justify-content-center flex-column text-center h-auto pb-5" id="lobby">
        <h1>LOBBY</h1>
        
        <table class="container table table-light h5">
            <thead>
                <tr>
                    <td>USERNAME</td>
                    <td>READY STATUS</td>
                </tr>
            </thead>
            <tbody id="lobby-body">

            </tbody>
        </table>
        <a class="btn btn-primary justify-content-center btn-lg active" onclick=buttonclicked(2)
                role="button" aria-pressed="true">READY</a>
        <a class="btn btn-primary justify-content-center btn-lg active" onclick=startMatchmaking()
                role="button" aria-pressed="true">START GAME</a>
    </div>

    <div class="container-fluid custom-body h-auto d-none" id="game">
        <div id="home" class="container-fluid text-center d-flex justify-content-center align-items-center py-3" style="height: fit-content">
            <div class="container">
                <div class="py-3 justify-content-center text-center flex-column d-flex container ">
                    <table class="wordSearchTable" id="wordSearchTable"></table>
                </div>
            </div>
            <div>
                <table class="h4 table table-light">
                    <tr class="h3">
                        <td id="playerOneName">@</td>
                        <td id="playerOneScore">1</td>
                        <td>VS</td>
                        <td id="playerOneScore">2</td>
                        <td id="playerTwoName">@</td>
                    </tr>
                </table>
                <p>FIND THE WORDS: <span id="wordList"></span></p>
                <!-- Multi-user chat box -->
                <div class="container-fluid">
                    <div class=" row justify-content-center">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header container-fluid">Chat</div>
                                <div class="card-body container-fluid" id="chatBox">
                                    <!-- Chat messages will be displayed here -->
                                </div>
                                <div class="card-footer container-fluid">
                                    <input type="text" class="form-control" id="chatMessage" placeholder="Type your message">
                                    <button class="btn btn-primary mt-2 container-fluid" id="sendMessage">Send</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>

    <div class="container-fluid custom-body d-none" id="profile">
        <div id="home" class="container-fluid text-center flex-column d-flex justify-content-center align-items-center"
            style="height: 100vh;">
            <h1 style="font-size: 5vw;">PROFILE</h1>
            <h2 > USERNAME: </h2>
            <h3 >GAMES WON: </h3>
            <h3 >GAMES LOST: </h3>
            <a class="btn btn-primary justify-content-center btn-lg active" onclick=goBackToGame()
                role="button" aria-pressed="true" >GO BACK</a>
        </div>
    </div>

    <!-- DO A FOR EACH LOOP TO DISPLAY THE PLAYERS IN THE LEADERBOARD -->
    <div data-aos="fade-up" class="d-flex justify-content-center flex-column text-center h-auto pb-5" id="leaderboard">
        <h1>LEADERBOARD</h1>
        
        <table class="container table table-light h5">
            <tr>
                <td>RANK</td>
                <td>PLAYER</td>
                <td>GAME WON</td>
            </tr>
            <tr>
                <td id="playerRank">1ST</td>
                <td id="playerName">@JOHNLEE123</td>
                <td id="playerGame"">12</td>
            </tr>
            <tr>
                <td id="playerRank">2ND</td>
                <td id="playerName">@JOHN123</td>
                <td id="playerGame"">10</td>
            </tr>
            <tr>
                <td id="playerRank">3RD</td>
                <td id="playerName">@JOHN123</td>
                <td id="playerGame"">10</td>
            </tr>
            <tr>
                <td id="playerRank">4TH</td>
                <td id="playerName">@JOHN123</td>
                <td id="playerGame"">10</td>
            </tr>
            <tr>
                <td id="playerRank">5TH</td>
                <td id="playerName">@JOHN123</td>
                <td id="playerGame"">10</td>
            </tr>
            <tr>
                <td id="playerRank">6TH</td>
                <td id="playerName">@JOHN123</td>
                <td id="playerGame"">10</td>
            </tr>
        </table>
    </div>

    </div>

    <section data-aos="fade-up" id="contact">
        <div class="container-fluid custom-footer">
            <div class="container d-flex flex-wrap justify-content-between align-items-center custom-contact">
                <p class="display-1">CONTACT US:</p>
                <ul class="list-unstyled">
                    <li class=" display-5">
                        <a href=""
                            class=" text-decoration-none text-light custom-contact-link" target="_blank">CUSTOMER
                            SUPPORT</a>
                    </li>
                    <li class=" display-5">
                        <a href="#" class="text-decoration-none text-light custom-contact-link" target="_blank">+1 123
                            456 7890</a>
                    </li>

                    <li class=" display-5">
                        <a href="mailto:hello@tienl.dev" class=" text-decoration-none text-light custom-contact-link"
                            target="_blank">HELLO@GMAIL.COM</a>
                    </li>
                </ul>
            </div>
            <footer class="text-center py-3">
                <div>
                    <p>&copy; 2024 TIEN LE FOR GROUP 26. ALL RIGHTS RESERVED</p>
                </div>
            </footer>
        </div>
    </section>
</div>




    <script src="bootstrap-5.3.3-dist/js/bootstrap.js"></script>
    <script src="bootstrap-5.3.3-dist/js/js.js"></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script src="bootstrap-5.3.3-dist/js/usernameValidation.js"></script>

    <script>AOS.init();</script>
    <!-- <script src="usernameValidation.js"></script> -->

    <script>
        let UserId = null;

        class UserEvent{
            request;
            GameId;
            UserId;
        }


        serverUrl = "ws://" + window.location.hostname +":"+ (parseInt(location.port) + 100);
        connection = new WebSocket(serverUrl);
        connection.onopen = function (evt) {
            console.log("open");
        }

        connection.onmessage = function(evt){

            let lobby = document.getElementById("lobby-body");
            lobby.innerHTML = "";
            var msg;
            msg = evt.data;
            let obj = JSON.parse(msg);

            console.log("Message received: " + msg);
            console.log("NUM USERS: " + obj.length)

            obj.forEach(function(obj){
                console.log("OBJECT: " + obj)
                var row = lobby.insertRow();
                var name = row.insertCell(0);
                var ready = row.insertCell(1);

                name.textContent = obj.user;
                if(obj.ready == false){
                    ready.textContent = "Not Ready";
                } else{
                    ready.textContent = "Ready";
                }
                
            });
        }

        function buttonclicked(value){
            U = new UserEvent;
            if(value == 1){
                let username = document.getElementById("username").value;
                this.UserId = username;
                U.UserId = username;
                U.request = 1;
                connection.send(JSON.stringify(U));
                let div = document.getElementById("log-in");
                div.innerHTML = "";
            } else if (value == 2){
                U.UserId = this.UserId;
                U.request = 2;
                connection.send(JSON.stringify(U));
            }
        }




        //document.getElementById("startMatchmakingBtn").addEventListener("click", startMatchmaking);

        function startMatchmaking() {
            // Hide matchmaking form
            document.getElementById("lobby").classList.add("d-none");

            // Hide profile elements
            document.getElementById("profile").classList.add("d-none");

            // Show game elements
            document.getElementById("game").classList.remove("d-none");

            // Update player names
            document.getElementById("playerOneName").innerText = "@" + UserId.toUpperCase();
            document.getElementById("playerTwoName").innerText = "@opponent"; // Replace "opponent" with actual opponent's name

            // Start matchmaking process or any other game initialization logic
        }

        document.getElementById("username").addEventListener("input", function(){
            var username = document.getElemenById("username").value;
            var goBackButton = document.getElementById("profileLink");
            if(username){
                profileLink.removeAttribute("disabled");
            }
            else{
                profileLink.setAttribute("diabled", true);
            }
        });

        function showProfile() {
            // Hide matchmaking form
            document.getElementById("lobby").classList.add("d-none");

            // Hide game elements
            document.getElementById("game").classList.add("d-none");

            
            // Show profile elements
            document.getElementById("profile").classList.remove("d-none");

            // Update player names
            // document.getElementById("playerOneName").innerText = "@" + UserId.toUpperCase();
            document.getElementById("playerTwoName").innerText = "@opponent"; // Replace "opponent" with actual opponent's name

            // Start matchmaking process or any other game initialization logic
        }

        function goBackToGame() {
            // Hide matchmaking form
            document.getElementById("lobby").classList.add("d-none");

            // Hide profile elements
            document.getElementById("profile").classList.add("d-none");

            // Show game elements
            document.getElementById("game").classList.remove("d-none");

            // Update player names
            // document.getElementById("playerOneName").innerText = "@" + UserId.toUpperCase();
            document.getElementById("playerTwoName").innerText = "@opponent"; // Replace "opponent" with actual opponent's name

            // Start matchmaking process or any other game initialization logic
        }

    </script>


    <script>
        /*
        document.getElementById("startMatchmakingBtn").addEventListener("click", startMatchmaking);

        function startMatchmaking() {
            const username = document.forms["userForm"]["fname"].value;
            if (username.trim() === "") {
                alert("Please enter a username.");
                return;
            }

            // Hide matchmaking form
            document.getElementById("matchmaking").classList.add("d-none");

            // Show game elements
            document.getElementById("game").classList.remove("d-none");

            // Update player names
            document.getElementById("playerOneName").innerText = "@" + username.toUpperCase();
            document.getElementById("playerTwoName").innerText = "@opponent"; // Replace "opponent" with actual opponent's name

            // Start matchmaking process or any other game initialization logic
        }
        */
    </script>

    <script>
        const wordsToFind = ['apple', 'banana', 'cherry', 'grape', 'orange', 'pear', 'kiwi', 'peach', 'mango','melon' ];
        const gridSize = 50;
        const table = document.getElementById('wordSearchTable');
        const wordListElement = document.getElementById('wordList');

        // Function to generate a random letter
        function getRandomLetter() {
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            return alphabet[Math.floor(Math.random() * alphabet.length)];
        }

        // Function to generate the word search grid
        function generateWordSearch() {
            for (let i = 0; i < gridSize; i++) {
                const row = table.insertRow();
                for (let j = 0; j < gridSize; j++) {
                    const cell = row.insertCell();
                    cell.textContent = getRandomLetter();
                }
            }
        }

        // Function to add words to the grid
        function addWordsToGrid() {
            for (const word of wordsToFind) {
                const direction = Math.random() < 0.5 ? 'horizontal' : 'vertical';
                const startX = Math.floor(Math.random() * (gridSize - word.length + 1));
                const startY = Math.floor(Math.random() * (gridSize - word.length + 1));

                for (let i = 0; i < word.length; i++) {
                    const cell = direction === 'horizontal' ? table.rows[startY].cells[startX + i] : table.rows[startY + i].cells[startX];
                    cell.textContent = word[i].toUpperCase();
                }
            }
        }

        // Function to display the list of words to find
        function displayWordList() {

            wordListElement.textContent = wordsToFind.sort()
                                                     .map(word => word.toUpperCase())
                                                     .join(', ');
        }

        // Generate and display the word search
        generateWordSearch();
        addWordsToGrid();
        displayWordList();
    </script>
</body>

</html>
